---
title: Fish Configuration
description: Fish-specific shell integration configuration and examples
---

This guide covers fish-specific configuration for fzf shell integration, including key bindings, fuzzy completion, and advanced customization.

## Setup

Add this line to your `~/.config/fish/config.fish`:

```fish
# Set up fzf key bindings
fzf --fish | source
```

<Note>
Requires fzf 0.48.0 or later. For older versions, see [Manual Setup](#manual-setup).
</Note>

## Manual Setup

For finer control or older fzf versions, source the scripts manually:

```fish
# Source key bindings
source /usr/share/doc/fzf/examples/key-bindings.fish

# Source fuzzy completion
source /usr/share/doc/fzf/examples/completion.fish
```

<Tip>
The minimum supported fish version is 3.1b1.
</Tip>

## Key Bindings

### CTRL-T: File Selection

Paste selected files onto the command-line:

```fish
vim <CTRL-T>
```

**Fish-specific behavior:** The last token on the command-line is used as the root directory:

```fish
# This searches within /var/
ls /var/<CTRL-T>

# This searches within current directory
ls <CTRL-T>
```

**Configuration:**

```fish
# Custom file listing command
set -gx FZF_CTRL_T_COMMAND 'fd --type f --hidden --follow --exclude .git'

# Custom fzf options
set -gx FZF_CTRL_T_OPTS "
  --walker-skip .git,node_modules,target
  --preview 'bat -n --color=always {}'
  --bind 'ctrl-/:change-preview-window(down|hidden|)'"
```

**Using $dir in custom commands:**

```fish
# $dir is the last token or current directory
set -g FZF_CTRL_T_COMMAND "command find -L \$dir -type f 2> /dev/null | sed '1d; s#^\./##'"
```

### CTRL-R: Command History

Search and paste commands from history:

```fish
<CTRL-R>
```

**Fish-specific features:**
- Syntax highlighting in preview (fish 4.3.3+)
- Delete history items with `Shift-Delete`
- Multi-line command support
- Integration with `fish_indent` for formatting

**Configuration:**

```fish
set -gx FZF_CTRL_R_OPTS "
  --bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort'
  --color header:italic
  --header 'Press CTRL-Y to copy command into clipboard'"
```

**Advanced preview customization:**

The fish history widget includes sophisticated preview logic:

```fish
# Dynamic preview that shows formatted command and timestamp
--preview="string collect -- (test \"\$FZF_SELECT_COUNT\" -gt 0; and string collect -- {+2..}) \"\\n# \"'$date_cmd' {2..} | fish_indent --ansi"
```

### ALT-C: Directory Navigation

Change to selected directory:

```fish
<ALT-C>
```

**Configuration:**

```fish
# Custom directory listing
set -gx FZF_ALT_C_COMMAND 'fd --type d --hidden --follow --exclude .git'

# Show directory tree in preview
set -gx FZF_ALT_C_OPTS "
  --walker-skip .git,node_modules,target
  --preview 'tree -C {}'"
```

### Disabling Key Bindings

Disable specific bindings by setting their command variable to empty:

```fish
# Disable CTRL-R and ALT-C
fzf --fish | FZF_CTRL_R_COMMAND= FZF_ALT_C_COMMAND= source
```

### Widget Implementation

Fish key bindings use functions:

```fish
# Bind functions to keys
if not set -q FZF_CTRL_R_COMMAND; or test -n "$FZF_CTRL_R_COMMAND"
  bind \cr fzf-history-widget
  bind -M insert \cr fzf-history-widget
end

if not set -q FZF_CTRL_T_COMMAND; or test -n "$FZF_CTRL_T_COMMAND"
  bind \ct fzf-file-widget
  bind -M insert \ct fzf-file-widget
end

if not set -q FZF_ALT_C_COMMAND; or test -n "$FZF_ALT_C_COMMAND"
  bind \ec fzf-cd-widget
  bind -M insert \ec fzf-cd-widget
end
```

## Fuzzy Completion

<Warning>
Fish fuzzy completion differs significantly from bash/zsh:

1. **No trigger sequence** - Uses `Shift-TAB` instead of `**<TAB>`
2. **Uses native completion** - Relies on fish's completion system
3. **Limited configuration** - Only `FZF_COMPLETION_OPTS` is supported
4. **For recursive search** - Use `CTRL-T` binding instead
</Warning>

### Basic Usage

```fish
# Regular TAB preserves fish's native completion
vim <TAB>

# Shift-TAB triggers fzf fuzzy completion
vim <SHIFT-TAB>
```

### Configuration

```fish
# Only FZF_COMPLETION_OPTS is supported in fish
set -gx FZF_COMPLETION_OPTS '--border --info=inline'
```

### Custom Completion Functions

Define `_fzf_complete_COMMAND` functions for custom completion:

```fish
function _fzf_complete_git
  switch $argv[2]
    case checkout switch
      _fzf_complete --reverse --no-preview -- $argv < (git branch --all --format='%(refname:short)' | psub)

    case add
      function _fzf_complete_git_post
        awk '{print $NF}'
      end
      _fzf_complete --multi --reverse -- $argv < (git status --short | psub)

    case show log diff
      function _fzf_complete_git_post
        awk '{print $1}'
      end
      _fzf_complete --reverse --no-sort --preview='git show --color=always {1}' -- $argv < (git log --oneline | psub)

    case ''
      __fzf_complete_native "$argv[1] " --query=(commandline -t | string escape)

    case '*'
      set -l -- current_token (commandline -t)
      __fzf_complete_native "$argv $current_token" --query=(string escape -- $current_token) --multi
  end

  functions -e _fzf_complete_git_post
end
```

### Fallback to Native Completion

Use `__fzf_complete_native` to fall back to fish's completion:

```fish
function _fzf_complete_mycommand
  # Use fzf for specific arguments
  if test (count $argv) -eq 2
    _fzf_complete --reverse -- $argv < (custom-list | psub)
  else
    # Fall back to native fish completion
    __fzf_complete_native "$argv[1] " --query=(commandline -t | string escape)
  end
end
```

## Custom Completion Examples

### Docker Management

```fish
function _fzf_complete_docker
  switch $argv[2]
    case start stop restart rm
      _fzf_complete --multi --reverse --prompt="container> " -- $argv < (
        docker ps -a --format '{{.Names}}' | psub
      )
    case exec
      _fzf_complete --reverse --prompt="container> " -- $argv < (
        docker ps --format '{{.Names}}' | psub
      )
    case rmi
      _fzf_complete --multi --reverse --prompt="image> " -- $argv < (
        docker images --format '{{.Repository}}:{{.Tag}}' | psub
      )
    case '*'
      __fzf_complete_native "docker $argv[2] " --query=(commandline -t | string escape)
  end
end
```

### Kubernetes Context Switching

```fish
function _fzf_complete_kubectl
  switch $argv[2]
    case config
      if test $argv[3] = "use-context"
        _fzf_complete --reverse --prompt="context> " -- $argv < (
          kubectl config get-contexts -o name | psub
        )
      else
        __fzf_complete_native "kubectl config " --query=(commandline -t | string escape)
      end
    case '*'
      __fzf_complete_native "kubectl $argv[2] " --query=(commandline -t | string escape)
  end
end
```

### SSH with Custom Host List

```fish
function _fzf_complete_ssh
  function _fzf_complete_ssh_post
    # Add user@ prefix if needed
    string replace -r '^' (string match -r '.*@' (commandline -t))
  end
  
  _fzf_complete --reverse --prompt="host> " -- $argv < (
    # Extract hosts from ssh config
    awk '/^Host / {print $2}' ~/.ssh/config | psub
  )
  
  functions -e _fzf_complete_ssh_post
end
```

### Process Kill

```fish
function _fzf_complete_kill
  set -l -- fzf_query (commandline -t | string escape)
  set -lx -- FZF_DEFAULT_OPTS (__fzf_defaults --reverse $FZF_COMPLETION_OPTS \
    --accept-nth=2 -m --header-lines=1 --no-preview --wrap)
  set -lx FZF_DEFAULT_OPTS_FILE
  
  if type -q ps
    set -l -- ps_cmd 'begin command ps -eo user,pid,ppid,start,time,command 2>/dev/null;' \
      'or command ps -eo user,pid,ppid,time,args 2>/dev/null;' \
      'or command ps --everyone --full --windows 2>/dev/null; end'
    set -l -- result (eval $ps_cmd \| (__fzfcmd) --query=$fzf_query)
    and commandline -rt -- (string join ' ' -- $result)" "
  else
    __fzf_complete_native "kill " --multi --query=$fzf_query
  end
  
  commandline -f repaint
end
```

## Advanced Configuration

### Command Line Parsing

Fish integration includes sophisticated command-line parsing:

```fish
# The __fzf_parse_commandline function extracts:
# - Current directory context
# - fzf query string
# - Optional prefix (for options like -i=)

set -l commandline (__fzf_parse_commandline)
set -lx dir $commandline[1]      # Root directory
set -l fzf_query $commandline[2]  # Query string
set -l prefix $commandline[3]     # Option prefix
```

### History with Syntax Highlighting

Fish 4.3.3+ supports syntax highlighting in history preview:

```fish
# Enable syntax highlighting colors
if set -l -- v (string match -r -- '^(\d+)\.(\d+)(?:\.(\d+))?' $version)
and test "$v[2]" -gt 4 -o "$v[2]" -eq 4 -a \
  \( "$v[3]" -gt 3 -o "$v[3]" -eq 3 -a \
  \( -n "$v[4]" -a "$v[4]" -ge 3 \) \)
  set -a -- FZF_DEFAULT_OPTS '--ansi'
  set -a -- FZF_DEFAULT_COMMAND '--color=always'
end
```

### Integration with tmux

Configure tmux integration:

```fish
# Use tmux popup
set -gx FZF_TMUX_OPTS '-p 80%,60%'

# Or traditional split
set -gx FZF_TMUX 1
set -gx FZF_TMUX_HEIGHT '40%'
```

### Respecting .gitignore

Use `fd` to respect `.gitignore` files:

```fish
# Use fd for CTRL-T
set -gx FZF_CTRL_T_COMMAND 'fd --type f --strip-cwd-prefix'

# Include hidden files but exclude .git
set -gx FZF_CTRL_T_COMMAND 'fd --type f --strip-cwd-prefix --hidden --follow --exclude .git'
```

## Complete Configuration Example

```fish
# ~/.config/fish/config.fish

# fzf setup
fzf --fish | source

# Key binding options
set -gx FZF_CTRL_T_COMMAND 'fd --type f --strip-cwd-prefix --hidden --follow --exclude .git'
set -gx FZF_CTRL_T_OPTS "
  --walker-skip .git,node_modules,target
  --preview 'bat -n --color=always {}'
  --bind 'ctrl-/:change-preview-window(down|hidden|)'"

set -gx FZF_CTRL_R_OPTS "
  --bind 'ctrl-y:execute-silent(echo -n {2..} | pbcopy)+abort'
  --color header:italic
  --header 'Press CTRL-Y to copy command into clipboard'"

set -gx FZF_ALT_C_COMMAND 'fd --type d --strip-cwd-prefix --hidden --follow --exclude .git'
set -gx FZF_ALT_C_OPTS "
  --walker-skip .git,node_modules,target
  --preview 'tree -C {}'"

# Completion options (fish only supports FZF_COMPLETION_OPTS)
set -gx FZF_COMPLETION_OPTS '--border --info=inline'

# Display options
set -gx FZF_DEFAULT_OPTS '--height 40% --layout=reverse --border'

# Custom git completion
function _fzf_complete_git
  switch $argv[2]
    case checkout switch
      _fzf_complete --reverse --no-preview -- $argv < (git branch --all --format='%(refname:short)' | psub)
    case add
      function _fzf_complete_git_post
        awk '{print $NF}'
      end
      _fzf_complete --multi --reverse -- $argv < (git status --short | psub)
    case show log diff
      function _fzf_complete_git_post
        awk '{print $1}'
      end
      _fzf_complete --reverse --no-sort --preview='git show --color=always {1}' -- $argv < (git log --oneline | psub)
    case '*'
      set -l -- current_token (commandline -t)
      __fzf_complete_native "$argv $current_token" --query=(string escape -- $current_token) --multi
  end
  functions -e _fzf_complete_git_post
end
```

## Version Compatibility

### Minimum Version

Fish 3.1b1 is the minimum supported version:

```fish
if set -l -- fish_ver (string match -r '^(\d+)\.(\d+)' $version 2>/dev/null)
and test "$fish_ver[2]" -lt 3 -o "$fish_ver[2]" -eq 3 -a "$fish_ver[3]" -lt 1
  echo "This script requires fish version 3.1b1 or newer." >&2
  return 1
end
```

### Feature Detection

The integration detects fish version for feature support:

```fish
# Fish 4.0+ uses tokens-expanded
if test (string match -r -- '^\d+' $version) -ge 4
  set -- tokens (commandline -xpc)
else
  set -- tokens (commandline -opc)
end
```

## See Also

<CardGroup cols={2}>
  <Card title="Key Bindings" icon="keyboard" href="/shell/key-bindings">
    Learn more about CTRL-T, CTRL-R, and ALT-C
  </Card>
  <Card title="Fuzzy Completion" icon="sparkles" href="/shell/fuzzy-completion">
    Detailed fuzzy completion documentation
  </Card>
</CardGroup>
